plugins {
    id 'org.jetbrains.kotlin.jvm' version '1.7.10'
}

repositories {
    mavenCentral()
}

dependencies {
    implementation 'org.jetbrains.kotlin:kotlin-stdlib:1.7.10'
}

task allJars {
    dependsOn('makeJar')
}

tasks.register('makeJar', CustomJar, project)

class CustomJar extends org.gradle.jvm.tasks.Jar {

    @javax.inject.Inject
    CustomJar(Project project) {
        manifest {
            attributes(
                    "Main-Class": "prime.MainKt",
            )
        }
        archiveFileName.set("primes.jar")

        from {} with project.jar

        destinationDirectory = project.file(project.rootDir)
    }
}

jar {
    from { configurations.compileClasspath.collect { it.isDirectory() ? it : zipTree(it) } }
}